
<!doctype html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0">
<link href="https://fonts.googleapis.com/css?family=Roboto|Noto+Sans+SC&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://dmo.asia/style.css" integrity="sha256-TJTrfD6xO+0aZj/AfPGsFybv8fQqfmeVpjgw1Jg+8uQ=" crossorigin="anonymous">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<title>DMO</title>
</head>
<body>
    <p></p>
<center>	
	<label class="btn btn-primary" for="imageLoader"><br><img src="https://cdn-icons-png.flaticon.com/128/685/685686.png" width="38px" alt="Add"><div id="name">Upload image</div></label>	
	<input type="file" id="imageLoader" name="imageLoader"/>
	<canvas id="imageCanvas"></canvas>
	<center><div id="img_div" onclick="showStuff('showBt', 'text1', this); return true;"></div></center>
	<script type="text/javascript">
		/* Know how you can contribute to the code: Simply go to the Github project's issue. */
		var imageLoader = document.getElementById("imageLoader");
      	imageLoader.addEventListener("change", handleImage, false);
      	var canvas = document.getElementById("imageCanvas");
      	var ctx = canvas.getContext("2d");
      	function handleImage(e) {
        var reader = new FileReader();
        reader.onload = function(event) {
        	var img = new Image();
          	img.crossOrigin = "*";
          	img.onload = function() {
            canvas.width = 1840;
            canvas.height = 3600;
            ctx.drawImage(img, 200, 200, 1440, 3200);
			
            var wm = new Image();
            wm.crossOrigin = "*";
            wm.onload = function() {
              ctx.drawImage(this, 0, 0, 1840, 3600);
              var base64 = canvas.toDataURL("image/png");
              var fileToSave = new Image();
              fileToSave.onload = function() {
                document.getElementById("img_div").appendChild(this);
              };
              fileToSave.src = base64;
            };
            wm.src =
              "../devices/bezelless_wgray.png";
          };
          img.src = event.target.result;
        };
        reader.readAsDataURL(e.target.files[0]);
		
document.getElementById('download').addEventListener('click', function(e) {
    // Convert our canvas to a data URL
    let canvasUrl = canvas.toDataURL();
    // Create an anchor, and set the href value to our data URL
    const createEl = document.createElement('a');
    createEl.href = canvasUrl;

    // This is the name of our downloaded file
    createEl.download = "download.png";

    // Click the download button, causing a download, and then remove it
    createEl.click();
    createEl.remove();
});
	}
	</script>
	<br>

	<p id="showBt" style="display: none;">
	<button class="btn btn-outline-primary" for="img_div" id="download"><i class="fa fa-download"></i> Download image</button>

	<script type="text/javascript">
  function showStuff(id) {
    document.getElementById(id).style.display='block';
  }

  function hideStuff(id) {
    document.getElementById(id).style.display='none';
  }
</script>
</body>
</html>
